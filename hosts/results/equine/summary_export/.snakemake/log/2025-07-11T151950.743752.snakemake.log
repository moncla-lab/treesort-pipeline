Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 6
Rules claiming more threads will be scaled down.
Job stats:
job          count
---------  -------
all              1
ancestral        1
export           1
traits           1
translate        1
total            5

Resources before job selection: {'_cores': 6, '_nodes': 9223372036854775807}
Ready jobs (2)
Select jobs to execute...
Selected jobs (2)
Resources after job selection: {'_cores': 4, '_nodes': 9223372036854775805}

[Fri Jul 11 15:19:51 2025]
Job 2: Inferring ancestral traits for host country region subtype order
Reason: Missing output files: summary_95/traits/traits_h3nx_ha.json; Set of input files has changed since last execution


        augur traits             --tree data/tree/summary.nwk             --metadata data/meta/h3nx_ha.csv             --output summary_95/traits/traits_h3nx_ha.json             --columns host country region subtype order             --confidence
        

[Fri Jul 11 15:19:51 2025]
Job 3: Reconstructing ancestral sequences and mutations
Reason: Missing output files: summary_95/div_tree/nt_muts/nt-muts_h3nx_ha.json; Set of input files has changed since last execution


        augur ancestral             --tree data/tree/summary.nwk             --alignment data/alignments/h3nx_ha.fasta             --output-node-data summary_95/div_tree/nt_muts/nt-muts_h3nx_ha.json             --inference joint            --keep-ambiguous
        
[Fri Jul 11 15:19:52 2025]
Finished job 3.
1 of 5 steps (20%) done
Resources before job selection: {'_cores': 5, '_nodes': 9223372036854775806}
Ready jobs (1)
Select jobs to execute...
Selected jobs (1)
Resources after job selection: {'_cores': 4, '_nodes': 9223372036854775805}

[Fri Jul 11 15:19:52 2025]
Job 4: Translating amino acid sequences
Reason: Missing output files: summary_95/div_tree/aa_muts/aa-muts_h3nx_ha.json; Input files updated by another job: summary_95/div_tree/nt_muts/nt-muts_h3nx_ha.json


        augur translate             --tree data/tree/summary.nwk             --ancestral-sequences summary_95/div_tree/nt_muts/nt-muts_h3nx_ha.json             --reference-sequence data/config/ref/h3nx_ha.gb             --output summary_95/div_tree/aa_muts/aa-muts_h3nx_ha.json
        
[Fri Jul 11 15:19:53 2025]
Finished job 4.
2 of 5 steps (40%) done
[Fri Jul 11 15:19:54 2025]
Finished job 2.
3 of 5 steps (60%) done
Resources before job selection: {'_cores': 6, '_nodes': 9223372036854775807}
Ready jobs (1)
Select jobs to execute...
Selected jobs (1)
Resources after job selection: {'_cores': 5, '_nodes': 9223372036854775806}

[Fri Jul 11 15:19:54 2025]
Job 1: Exporting data files for for auspice
Reason: Missing output files: summary_95/treesort_auspice/treesort_ha_h3nx.json; Input files updated by another job: summary_95/traits/traits_h3nx_ha.json, summary_95/div_tree/aa_muts/aa-muts_h3nx_ha.json, summary_95/div_tree/nt_muts/nt-muts_h3nx_ha.json


        augur export v2             --tree data/tree/summary.nwk             --metadata data/meta/h3nx_ha.csv             --node-data data/summary_reassortment.json summary_95/traits/traits_h3nx_ha.json summary_95/div_tree/nt_muts/nt-muts_h3nx_ha.json summary_95/div_tree/aa_muts/aa-muts_h3nx_ha.json            --auspice-config data/config/auspice_config_h3nx.json             --include-root-sequence 			--colors data/config/colors_h3nx.tsv 			--lat-longs data/config/lat_longs_h3nx.tsv             --output summary_95/treesort_auspice/treesort_ha_h3nx.json
        
Full Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/snakemake/executors/__init__.py", line 2656, in run_wrapper
    run(
  File "/nextstrain/build/Snakefile", line 217, in __rule_export
  File "/usr/local/lib/python3.10/site-packages/snakemake/shell.py", line 294, in __new__
    raise sp.CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command 'set -euo pipefail;  
        augur export v2             --tree data/tree/summary.nwk             --metadata data/meta/h3nx_ha.csv             --node-data data/summary_reassortment.json summary_95/traits/traits_h3nx_ha.json summary_95/div_tree/nt_muts/nt-muts_h3nx_ha.json summary_95/div_tree/aa_muts/aa-muts_h3nx_ha.json            --auspice-config data/config/auspice_config_h3nx.json             --include-root-sequence 			--colors data/config/colors_h3nx.tsv 			--lat-longs data/config/lat_longs_h3nx.tsv             --output summary_95/treesort_auspice/treesort_ha_h3nx.json' returned non-zero exit status 2.

[Fri Jul 11 15:19:55 2025]
Error in rule export:
    jobid: 1
    input: data/tree/summary.nwk, data/meta/h3nx_ha.csv, data/summary_reassortment.json, summary_95/traits/traits_h3nx_ha.json, summary_95/div_tree/nt_muts/nt-muts_h3nx_ha.json, summary_95/div_tree/aa_muts/aa-muts_h3nx_ha.json, data/config/auspice_config_h3nx.json, data/config/colors_h3nx.tsv, data/config/lat_longs_h3nx.tsv
    output: summary_95/treesort_auspice/treesort_ha_h3nx.json
    shell:
        
        augur export v2             --tree data/tree/summary.nwk             --metadata data/meta/h3nx_ha.csv             --node-data data/summary_reassortment.json summary_95/traits/traits_h3nx_ha.json summary_95/div_tree/nt_muts/nt-muts_h3nx_ha.json summary_95/div_tree/aa_muts/aa-muts_h3nx_ha.json            --auspice-config data/config/auspice_config_h3nx.json             --include-root-sequence 			--colors data/config/colors_h3nx.tsv 			--lat-longs data/config/lat_longs_h3nx.tsv             --output summary_95/treesort_auspice/treesort_ha_h3nx.json
        
        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)

Full Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/snakemake/executors/__init__.py", line 2656, in run_wrapper
    run(
  File "/nextstrain/build/Snakefile", line 217, in __rule_export
  File "/usr/local/lib/python3.10/site-packages/snakemake/shell.py", line 294, in __new__
    raise sp.CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command 'set -euo pipefail;  
        augur export v2             --tree data/tree/summary.nwk             --metadata data/meta/h3nx_ha.csv             --node-data data/summary_reassortment.json summary_95/traits/traits_h3nx_ha.json summary_95/div_tree/nt_muts/nt-muts_h3nx_ha.json summary_95/div_tree/aa_muts/aa-muts_h3nx_ha.json            --auspice-config data/config/auspice_config_h3nx.json             --include-root-sequence 			--colors data/config/colors_h3nx.tsv 			--lat-longs data/config/lat_longs_h3nx.tsv             --output summary_95/treesort_auspice/treesort_ha_h3nx.json' returned non-zero exit status 2.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/snakemake/executors/__init__.py", line 715, in _callback
    raise ex
  File "/usr/local/lib/python3.10/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.10/site-packages/snakemake/executors/__init__.py", line 699, in cached_or_run
    run_func(*args)
  File "/usr/local/lib/python3.10/site-packages/snakemake/executors/__init__.py", line 2692, in run_wrapper
    raise RuleException(
snakemake.exceptions.RuleException: CalledProcessError in file /nextstrain/build/Snakefile, line 104:
Command 'set -euo pipefail;  
        augur export v2             --tree data/tree/summary.nwk             --metadata data/meta/h3nx_ha.csv             --node-data data/summary_reassortment.json summary_95/traits/traits_h3nx_ha.json summary_95/div_tree/nt_muts/nt-muts_h3nx_ha.json summary_95/div_tree/aa_muts/aa-muts_h3nx_ha.json            --auspice-config data/config/auspice_config_h3nx.json             --include-root-sequence 			--colors data/config/colors_h3nx.tsv 			--lat-longs data/config/lat_longs_h3nx.tsv             --output summary_95/treesort_auspice/treesort_ha_h3nx.json' returned non-zero exit status 2.
  File "/nextstrain/build/Snakefile", line 104, in __rule_export

RuleException:
CalledProcessError in file /nextstrain/build/Snakefile, line 104:
Command 'set -euo pipefail;  
        augur export v2             --tree data/tree/summary.nwk             --metadata data/meta/h3nx_ha.csv             --node-data data/summary_reassortment.json summary_95/traits/traits_h3nx_ha.json summary_95/div_tree/nt_muts/nt-muts_h3nx_ha.json summary_95/div_tree/aa_muts/aa-muts_h3nx_ha.json            --auspice-config data/config/auspice_config_h3nx.json             --include-root-sequence 			--colors data/config/colors_h3nx.tsv 			--lat-longs data/config/lat_longs_h3nx.tsv             --output summary_95/treesort_auspice/treesort_ha_h3nx.json' returned non-zero exit status 2.
  File "/nextstrain/build/Snakefile", line 104, in __rule_export
  File "/usr/local/lib/python3.10/concurrent/futures/thread.py", line 58, in run
Shutting down, this might take some time.
Exiting because a job execution failed. Look above for error message
Complete log: .snakemake/log/2025-07-11T151950.743752.snakemake.log
unlocking
removing lock
removing lock
removed all locks
